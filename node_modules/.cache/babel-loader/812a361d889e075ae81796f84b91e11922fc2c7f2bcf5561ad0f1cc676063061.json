{"ast":null,"code":"import React,{useRef}from'react';import*as XLSX from'xlsx';import logo from'./logo.svg';import'./App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const hardware_projects=[\"射箭比赛\",\"布袋球\",\"百米短跑\",\"划艇比赛\",\"滑板比赛\",\"掰手腕\",\"投篮大师\",\"谁是大力士\",\"新乒乓球大战\",\"跳绳抛射\",\"耐力跳跃\",\"乒乓球大战\",\"打水漂\",\"飞盘射击\",\"toio 保龄球\",\"太鼓小火车\",\"魔法烟花秀\",\"魔杖泡泡龙\",\"合成大西瓜\",\"投篮挑战\"];function App(){const inputRef=useRef();const handleFile=async e=>{const file=e.target.files[0];const data=await file.arrayBuffer();const workbook=XLSX.read(data);const sheet=workbook.Sheets[workbook.SheetNames[0]];const json=XLSX.utils.sheet_to_json(sheet);// 分类\njson.forEach(row=>{row['项目类型']=hardware_projects.includes(row['小类'])?'硬件项目':'纯软项目';});// 门店前3\nconst storeMap={};json.forEach(row=>{const key=\"\".concat(row['门店'],\"_\").concat(row['项目类型']);if(!storeMap[key])storeMap[key]={};storeMap[key][row['小类']]=(storeMap[key][row['小类']]||0)+row['时长（小时）'];});const storeTop3=[];Object.entries(storeMap).forEach(_ref=>{let[key,value]=_ref;const[store,type]=key.split('_');Object.entries(value).sort((a,b)=>b[1]-a[1]).slice(0,3).forEach(_ref2=>{let[proj,hours]=_ref2;storeTop3.push({门店:store,项目类型:type,小类:proj,总时长:hours});});});// 汇总\nconst sumMap={};json.forEach(row=>{const key=\"\".concat(row['项目类型'],\"_\").concat(row['小类']);sumMap[key]=(sumMap[key]||0)+row['时长（小时）'];});const summary=[];['硬件项目','纯软项目'].forEach(type=>{Object.entries(sumMap).filter(_ref3=>{let[k]=_ref3;return k.startsWith(type);}).sort((a,b)=>b[1]-a[1]).slice(0,3).forEach(_ref4=>{let[k,hours]=_ref4;summary.push({项目类型:type,小类:k.split('_')[1],总时长:hours});});});// 导出\nconst wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,XLSX.utils.json_to_sheet(storeTop3),'门店前3项目');XLSX.utils.book_append_sheet(wb,XLSX.utils.json_to_sheet(summary),'汇总');XLSX.writeFile(wb,'整理结果.xlsx');};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"App-header\",children:[/*#__PURE__*/_jsx(\"img\",{src:logo,className:\"App-logo\",alt:\"logo\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Edit \",/*#__PURE__*/_jsx(\"code\",{children:\"src/App.js\"}),\" and save to reload.\"]}),/*#__PURE__*/_jsx(\"a\",{className:\"App-link\",href:\"https://reactjs.org\",target:\"_blank\",rel:\"noopener noreferrer\",children:\"Learn React\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".xlsx,.xls\",ref:inputRef,onChange:handleFile}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u4E0A\\u4F20Excel\\u6587\\u4EF6\\uFF0C\\u81EA\\u52A8\\u6574\\u7406\\u5E76\\u4E0B\\u8F7D\\u7ED3\\u679C\"})]})]});}export default App;","map":{"version":3,"names":["React","useRef","XLSX","logo","jsx","_jsx","jsxs","_jsxs","hardware_projects","App","inputRef","handleFile","e","file","target","files","data","arrayBuffer","workbook","read","sheet","Sheets","SheetNames","json","utils","sheet_to_json","forEach","row","includes","storeMap","key","concat","storeTop3","Object","entries","_ref","value","store","type","split","sort","a","b","slice","_ref2","proj","hours","push","门店","项目类型","小类","总时长","sumMap","summary","filter","_ref3","k","startsWith","_ref4","wb","book_new","book_append_sheet","json_to_sheet","writeFile","className","children","src","alt","href","rel","accept","ref","onChange"],"sources":["/Users/elite/projece data/excel-analyze/src/App.js"],"sourcesContent":["import React, { useRef } from 'react';\nimport * as XLSX from 'xlsx';\nimport logo from './logo.svg';\nimport './App.css';\n\nconst hardware_projects = [\n  \"射箭比赛\", \"布袋球\", \"百米短跑\", \"划艇比赛\", \"滑板比赛\", \"掰手腕\",\n  \"投篮大师\", \"谁是大力士\", \"新乒乓球大战\", \"跳绳抛射\", \"耐力跳跃\", \"乒乓球大战\",\n  \"打水漂\", \"飞盘射击\", \"toio 保龄球\", \"太鼓小火车\", \"魔法烟花秀\", \"魔杖泡泡龙\",\n  \"合成大西瓜\", \"投篮挑战\"\n];\n\nfunction App() {\n  const inputRef = useRef();\n\n  const handleFile = async (e) => {\n    const file = e.target.files[0];\n    const data = await file.arrayBuffer();\n    const workbook = XLSX.read(data);\n    const sheet = workbook.Sheets[workbook.SheetNames[0]];\n    const json = XLSX.utils.sheet_to_json(sheet);\n\n    // 分类\n    json.forEach(row => {\n      row['项目类型'] = hardware_projects.includes(row['小类']) ? '硬件项目' : '纯软项目';\n    });\n\n    // 门店前3\n    const storeMap = {};\n    json.forEach(row => {\n      const key = `${row['门店']}_${row['项目类型']}`;\n      if (!storeMap[key]) storeMap[key] = {};\n      storeMap[key][row['小类']] = (storeMap[key][row['小类']] || 0) + row['时长（小时）'];\n    });\n    const storeTop3 = [];\n    Object.entries(storeMap).forEach(([key, value]) => {\n      const [store, type] = key.split('_');\n      Object.entries(value)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 3)\n        .forEach(([proj, hours]) => {\n          storeTop3.push({ 门店: store, 项目类型: type, 小类: proj, 总时长: hours });\n        });\n    });\n\n    // 汇总\n    const sumMap = {};\n    json.forEach(row => {\n      const key = `${row['项目类型']}_${row['小类']}`;\n      sumMap[key] = (sumMap[key] || 0) + row['时长（小时）'];\n    });\n    const summary = [];\n    ['硬件项目', '纯软项目'].forEach(type => {\n      Object.entries(sumMap)\n        .filter(([k]) => k.startsWith(type))\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 3)\n        .forEach(([k, hours]) => {\n          summary.push({ 项目类型: type, 小类: k.split('_')[1], 总时长: hours });\n        });\n    });\n\n    // 导出\n    const wb = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(storeTop3), '门店前3项目');\n    XLSX.utils.book_append_sheet(wb, XLSX.utils.json_to_sheet(summary), '汇总');\n    XLSX.writeFile(wb, '整理结果.xlsx');\n  };\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\n        <p>\n          Edit <code>src/App.js</code> and save to reload.\n        </p>\n        <a\n          className=\"App-link\"\n          href=\"https://reactjs.org\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          Learn React\n        </a>\n      </header>\n      <div>\n        <input type=\"file\" accept=\".xlsx,.xls\" ref={inputRef} onChange={handleFile} />\n        <p>上传Excel文件，自动整理并下载结果</p>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,MAAM,KAAQ,OAAO,CACrC,MAAO,GAAK,CAAAC,IAAI,KAAM,MAAM,CAC5B,MAAO,CAAAC,IAAI,KAAM,YAAY,CAC7B,MAAO,WAAW,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnB,KAAM,CAAAC,iBAAiB,CAAG,CACxB,MAAM,CAAE,KAAK,CAAE,MAAM,CAAE,MAAM,CAAE,MAAM,CAAE,KAAK,CAC5C,MAAM,CAAE,OAAO,CAAE,QAAQ,CAAE,MAAM,CAAE,MAAM,CAAE,OAAO,CAClD,KAAK,CAAE,MAAM,CAAE,UAAU,CAAE,OAAO,CAAE,OAAO,CAAE,OAAO,CACpD,OAAO,CAAE,MAAM,CAChB,CAED,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACb,KAAM,CAAAC,QAAQ,CAAGT,MAAM,CAAC,CAAC,CAEzB,KAAM,CAAAU,UAAU,CAAG,KAAO,CAAAC,CAAC,EAAK,CAC9B,KAAM,CAAAC,IAAI,CAAGD,CAAC,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAC9B,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAH,IAAI,CAACI,WAAW,CAAC,CAAC,CACrC,KAAM,CAAAC,QAAQ,CAAGhB,IAAI,CAACiB,IAAI,CAACH,IAAI,CAAC,CAChC,KAAM,CAAAI,KAAK,CAAGF,QAAQ,CAACG,MAAM,CAACH,QAAQ,CAACI,UAAU,CAAC,CAAC,CAAC,CAAC,CACrD,KAAM,CAAAC,IAAI,CAAGrB,IAAI,CAACsB,KAAK,CAACC,aAAa,CAACL,KAAK,CAAC,CAE5C;AACAG,IAAI,CAACG,OAAO,CAACC,GAAG,EAAI,CAClBA,GAAG,CAAC,MAAM,CAAC,CAAGnB,iBAAiB,CAACoB,QAAQ,CAACD,GAAG,CAAC,IAAI,CAAC,CAAC,CAAG,MAAM,CAAG,MAAM,CACvE,CAAC,CAAC,CAEF;AACA,KAAM,CAAAE,QAAQ,CAAG,CAAC,CAAC,CACnBN,IAAI,CAACG,OAAO,CAACC,GAAG,EAAI,CAClB,KAAM,CAAAG,GAAG,IAAAC,MAAA,CAAMJ,GAAG,CAAC,IAAI,CAAC,MAAAI,MAAA,CAAIJ,GAAG,CAAC,MAAM,CAAC,CAAE,CACzC,GAAI,CAACE,QAAQ,CAACC,GAAG,CAAC,CAAED,QAAQ,CAACC,GAAG,CAAC,CAAG,CAAC,CAAC,CACtCD,QAAQ,CAACC,GAAG,CAAC,CAACH,GAAG,CAAC,IAAI,CAAC,CAAC,CAAG,CAACE,QAAQ,CAACC,GAAG,CAAC,CAACH,GAAG,CAAC,IAAI,CAAC,CAAC,EAAI,CAAC,EAAIA,GAAG,CAAC,QAAQ,CAAC,CAC5E,CAAC,CAAC,CACF,KAAM,CAAAK,SAAS,CAAG,EAAE,CACpBC,MAAM,CAACC,OAAO,CAACL,QAAQ,CAAC,CAACH,OAAO,CAACS,IAAA,EAAkB,IAAjB,CAACL,GAAG,CAAEM,KAAK,CAAC,CAAAD,IAAA,CAC5C,KAAM,CAACE,KAAK,CAAEC,IAAI,CAAC,CAAGR,GAAG,CAACS,KAAK,CAAC,GAAG,CAAC,CACpCN,MAAM,CAACC,OAAO,CAACE,KAAK,CAAC,CAClBI,IAAI,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAKA,CAAC,CAAC,CAAC,CAAC,CAAGD,CAAC,CAAC,CAAC,CAAC,CAAC,CAC3BE,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CACXjB,OAAO,CAACkB,KAAA,EAAmB,IAAlB,CAACC,IAAI,CAAEC,KAAK,CAAC,CAAAF,KAAA,CACrBZ,SAAS,CAACe,IAAI,CAAC,CAAEC,EAAE,CAAEX,KAAK,CAAEY,IAAI,CAAEX,IAAI,CAAEY,EAAE,CAAEL,IAAI,CAAEM,GAAG,CAAEL,KAAM,CAAC,CAAC,CACjE,CAAC,CAAC,CACN,CAAC,CAAC,CAEF;AACA,KAAM,CAAAM,MAAM,CAAG,CAAC,CAAC,CACjB7B,IAAI,CAACG,OAAO,CAACC,GAAG,EAAI,CAClB,KAAM,CAAAG,GAAG,IAAAC,MAAA,CAAMJ,GAAG,CAAC,MAAM,CAAC,MAAAI,MAAA,CAAIJ,GAAG,CAAC,IAAI,CAAC,CAAE,CACzCyB,MAAM,CAACtB,GAAG,CAAC,CAAG,CAACsB,MAAM,CAACtB,GAAG,CAAC,EAAI,CAAC,EAAIH,GAAG,CAAC,QAAQ,CAAC,CAClD,CAAC,CAAC,CACF,KAAM,CAAA0B,OAAO,CAAG,EAAE,CAClB,CAAC,MAAM,CAAE,MAAM,CAAC,CAAC3B,OAAO,CAACY,IAAI,EAAI,CAC/BL,MAAM,CAACC,OAAO,CAACkB,MAAM,CAAC,CACnBE,MAAM,CAACC,KAAA,MAAC,CAACC,CAAC,CAAC,CAAAD,KAAA,OAAK,CAAAC,CAAC,CAACC,UAAU,CAACnB,IAAI,CAAC,GAAC,CACnCE,IAAI,CAAC,CAACC,CAAC,CAAEC,CAAC,GAAKA,CAAC,CAAC,CAAC,CAAC,CAAGD,CAAC,CAAC,CAAC,CAAC,CAAC,CAC3BE,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CACXjB,OAAO,CAACgC,KAAA,EAAgB,IAAf,CAACF,CAAC,CAAEV,KAAK,CAAC,CAAAY,KAAA,CAClBL,OAAO,CAACN,IAAI,CAAC,CAAEE,IAAI,CAAEX,IAAI,CAAEY,EAAE,CAAEM,CAAC,CAACjB,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAEY,GAAG,CAAEL,KAAM,CAAC,CAAC,CAC/D,CAAC,CAAC,CACN,CAAC,CAAC,CAEF;AACA,KAAM,CAAAa,EAAE,CAAGzD,IAAI,CAACsB,KAAK,CAACoC,QAAQ,CAAC,CAAC,CAChC1D,IAAI,CAACsB,KAAK,CAACqC,iBAAiB,CAACF,EAAE,CAAEzD,IAAI,CAACsB,KAAK,CAACsC,aAAa,CAAC9B,SAAS,CAAC,CAAE,QAAQ,CAAC,CAC/E9B,IAAI,CAACsB,KAAK,CAACqC,iBAAiB,CAACF,EAAE,CAAEzD,IAAI,CAACsB,KAAK,CAACsC,aAAa,CAACT,OAAO,CAAC,CAAE,IAAI,CAAC,CACzEnD,IAAI,CAAC6D,SAAS,CAACJ,EAAE,CAAE,WAAW,CAAC,CACjC,CAAC,CAED,mBACEpD,KAAA,QAAKyD,SAAS,CAAC,KAAK,CAAAC,QAAA,eAClB1D,KAAA,WAAQyD,SAAS,CAAC,YAAY,CAAAC,QAAA,eAC5B5D,IAAA,QAAK6D,GAAG,CAAE/D,IAAK,CAAC6D,SAAS,CAAC,UAAU,CAACG,GAAG,CAAC,MAAM,CAAE,CAAC,cAClD5D,KAAA,MAAA0D,QAAA,EAAG,OACI,cAAA5D,IAAA,SAAA4D,QAAA,CAAM,YAAU,CAAM,CAAC,uBAC9B,EAAG,CAAC,cACJ5D,IAAA,MACE2D,SAAS,CAAC,UAAU,CACpBI,IAAI,CAAC,qBAAqB,CAC1BtD,MAAM,CAAC,QAAQ,CACfuD,GAAG,CAAC,qBAAqB,CAAAJ,QAAA,CAC1B,aAED,CAAG,CAAC,EACE,CAAC,cACT1D,KAAA,QAAA0D,QAAA,eACE5D,IAAA,UAAOiC,IAAI,CAAC,MAAM,CAACgC,MAAM,CAAC,YAAY,CAACC,GAAG,CAAE7D,QAAS,CAAC8D,QAAQ,CAAE7D,UAAW,CAAE,CAAC,cAC9EN,IAAA,MAAA4D,QAAA,CAAG,2FAAmB,CAAG,CAAC,EACvB,CAAC,EACH,CAAC,CAEV,CAEA,cAAe,CAAAxD,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}